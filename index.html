<!DOCTYPE html>
<html>
<head>
  <title>ColorMatch - The Professional's Breaktime Game</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Inconsolata&display=swap');

  
body {
  font-family: 'Roboto', sans-serif;
  background: #ffffff;
  
  color: #333;
  padding: 50px;
  display: flex;
  justify-content: space-around;
  flex-wrap: wrap;
  background: white;
  background: linear-gradient(45deg, #a5d7c3, #d7acc2, #cad49f, #8fabb8);
  background-size: 600% 100%;
  animation: Gradient 15s ease infinite;
  flex-direction: row; /* make the layout horizontal */
  flex-wrap: nowrap; /* disable wrapping */
}

#gameContent, #scoreCard {
  flex-basis: 45%; /* adjust the width of each card */
  margin-bottom: 30px;
  background-color: #fff;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0px 5px 15px rgba(0,0,0,0.1);
}
    #colorSquare, #smallColorSquare {
      margin: 20px auto;
      border-radius: 10px;
    }
    #colorSquare {
      width: 300px;
      height: 300px;
      background-color: rgb(0, 0, 0);
    }
    #confetti {
  pointer-events: none;
  position: absolute;
  z-index: 10;
  top: 0; left: 0; right: 0; bottom: 0;
  overflow: hidden;
}
@keyframes Gradient {
  0% { background-position: 0% 50% }
  50% { background-position: 100% 50% }
  100% { background-position: 0% 50% }
}
    #smallColorSquare {
      width: 100px;
      height: 100px;
      background-color: rgb(0, 0, 0);
    }
    h1, h2 {
      font-family: 'Inconsolata', monospace;
      text-align: center;
      color: #333;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: #ffffff;
      background: #6051ce;
      transition: all 1s;
      font-family: 'Inconsolata', monospace;
    }
    button:hover {
      background-position: 100% 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      color: #333;
      font-family: 'Roboto', sans-serif;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
      background-color: #fff;
    }
    tr:nth-child(even) {background-color: #f2f2f2;}

    .highlighted {
  border: 2px solid green;
}

  </style>
   <script src="https://cdn.jsdelivr.net/gh/Agezao/confetti-js@master/index.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.3.2/dist/confetti.min.js"></script>


</head>
<body> 
    <canvas id="confetti"></canvas>
  <div id="gameContent">
    <h1>ColorMatch</h1>
    <h2>The Professional's Breaktime Game</h2>
    <div id="colorSquare"></div>
    <div id="smallColorSquare"></div>
    <button onclick="changeColor()">Generate Color</button>
    <button onclick="openColorPicker()">Pick Color</button>
    <button onclick="revealAnswer()">Reveal Answer</button>
  </div>
  <div id="scoreCard">
    <table>
      <thead>
        <tr>
          <th>Round</th>
          <th>Player 1</th>
          <th>Player 2</th>
        </tr>
      </thead>
      <tbody>
        <!-- 10 rows for 10 rounds -->
        <tr id="row1"><td>1</td><td id="score1-1"></td><td id="score2-1"></td></tr>
        <tr id="row2"><td>2</td><td id="score1-2"></td><td id="score2-2"></td></tr>
        <tr id="row3"><td>3</td><td id="score1-3"></td><td id="score2-3"></td></tr>
        <tr id="row4"><td>4</td><td id="score1-4"></td><td id="score2-4"></td></tr>
        <tr id="row5"><td>5</td><td id="score1-5"></td><td id="score2-5"></td></tr>
        <tr id="row6"><td>6</td><td id="score1-6"></td><td id="score2-6"></td></tr>
        <tr id="row7"><td>7</td><td id="score1-7"></td><td id="score2-7"></td></tr>
        <tr id="row8"><td>8</td><td id="score1-8"></td><td id="score2-8"></td></tr>
        <tr id="row9"><td>9</td><td id="score1-9"></td><td id="score2-9"></td></tr>
        <!-- ... add more rows here ... -->
        <tr id="row10"><td>10</td><td id="score1-10"></td><td id="score2-10"></td></tr>
      </tbody>
      <tfoot>
        <tr>
          <th>Average</th>
          <td id="average1">0</td>
          <td id="average2">0</td>
        </tr>
      </tfoot>
    </table>
    <button onclick="setPlayers(1)">1 Player</button>
    <button onclick="setPlayers(2)">2 Players</button>
    <button onclick="setPlayers(3)">3 Players</button>
    <button onclick="setPlayers(4)">4 Players</button>

  </div>
  <script defer>
   var answerRGB = [0, 0, 0]; 
var storedRGB = [0, 0, 0]; 
var answerColor = "rgb(0, 0, 0)"; 


var scores = [[]]; // An array of arrays to store the scores of all players
 // An array of arrays to store the scores of all players
var currentPlayer = 0; // Start with player 1 (0 index)
var rounds = []; // Current round for each player
var playerCount = 2; // Default to two players

function setPlayers(number) {
  playerCount = number;
  // Clear the scores and rounds
  scores = Array.from({length: number}, () => []);
  rounds = new Array(number).fill(1);
  // Clear the table
  var table = document.querySelector("table tbody");
  while (table.firstChild) {
    table.removeChild(table.firstChild);
  }
  // Generate new table rows for rounds and columns for players
  for (var i = 1; i <= 10; i++) {
    var row = table.insertRow();
    row.insertCell(0).innerHTML = "Round " + i;
    for (var j = 1; j <= number; j++) {
      var cell = row.insertCell(j);
      cell.id = "score" + j + "-" + i; // To adjust for player index and round
    }
  }
  // Adjust the table header
  var header = document.querySelector("table thead tr");
  while (header.children.length > 1) {
    header.removeChild(header.lastChild);
  }
  for (var i = 1; i <= number; i++) {
    var th = document.createElement('th');
    th.textContent = "Player " + i;
    header.appendChild(th);
  }
}




function createCell(type, text) {
  var td = document.createElement(type);
  var textNode = document.createTextNode(text);
  td.appendChild(textNode);
  return td;
}



function calculateScore() {
      var distance = Math.sqrt(
        Math.pow(answerRGB[0] - storedRGB[0], 2) +
        Math.pow(answerRGB[1] - storedRGB[1], 2) +
        Math.pow(answerRGB[2] - storedRGB[2], 2)
      );
      var maxDistance = Math.sqrt(3 * Math.pow(255, 2));
      var score = 100 - (distance / maxDistance * 100);

     // if (score >= 80) triggerConfetti(); // If score is 90 or higher, trigger confetti
      return score; // return score as number
    }

// Function to trigger confetti animation
   // Function to trigger confetti animation
   function triggerConfetti() {
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 }
      });
    }

// Initialize the game state
var gameState = 0; // 0 = "Generate Color", 1 = "Pick Color", 2 = "Reveal Answer"

function changeColor() {
  if (gameState !== 0) return; // If not in correct state, don't proceed

  var red = Math.floor(Math.random() * 256);
  var green = Math.floor(Math.random() * 256);
  var blue = Math.floor(Math.random() * 256);
  answerRGB = [red, green, blue];
  answerColor = "rgb(" + red + ", " + green + ", " + blue + ")";
  document.getElementById("colorSquare").style.backgroundColor = answerColor;
  setTimeout(function() {
    document.getElementById("colorSquare").style.backgroundColor = "white";
  }, 5000);
  gameState = 1; // Move to next state
}

function openColorPicker() {
  if (gameState !== 1) return; // If not in correct state, don't proceed

  var colorPicker = document.createElement("input");
  colorPicker.type = "color";
  colorPicker.oninput = function() {
    document.getElementById("smallColorSquare").style.backgroundColor = this.value;
    var red = parseInt(this.value.slice(1, 3), 16);
    var green = parseInt(this.value.slice(3, 5), 16);
    var blue = parseInt(this.value.slice(5, 7), 16);
    storedRGB = [red, green, blue];
  };
  colorPicker.click();
  gameState = 2; // Move to next state
}

function highlightHighestScore() {
  // Loop through each round
  for (let i = 1; i <= 10; i++) {
    let highScore = 0;
    let highScoreElements = [];
    // Loop through each player
    for (let j = 0; j < playerCount; j++) {
      let scoreEl = document.getElementById(`score${j+1}-${i}`);
      let playerScore = Number(scoreEl.textContent.slice(0, -1));

      // Remove previous highlight
      scoreEl.classList.remove('highlighted');

      // Compare scores and remember the highest
      if (playerScore > highScore) {
        highScore = playerScore;
        highScoreElements = [scoreEl];
      } else if (playerScore === highScore) {
        highScoreElements.push(scoreEl);
      }
    }
    // Highlight the highest score(s)
    highScoreElements.forEach(el => el.classList.add('highlighted'));
  }
}


function revealAnswer() {
  if (gameState !== 2) return; // If not in correct state, don't proceed

  if (scores[currentPlayer] === undefined) {
    alert("Please set the number of players first.");
    return;
  }

  document.getElementById("colorSquare").style.backgroundColor = answerColor;
  var score = calculateScore();
  scores[currentPlayer].push(score); // store score as number
  document.getElementById(`score${currentPlayer+1}-${rounds[currentPlayer]}`).textContent = score.toFixed(2) + "%"; // convert score to string here
  document.getElementById(`average${currentPlayer+1}`).textContent = (scores[currentPlayer].reduce((a, b) => a + b) / scores[currentPlayer].length).toFixed(2) + "%"; // convert average to string here
  rounds[currentPlayer]++; // Move to next round for this player
  currentPlayer = (currentPlayer + 1) % playerCount; // Switch player

  gameState = 0; // Reset to initial state

  // Call the function to highlight the highest score
  highlightHighestScore();
}




  </script>
</body>
</html>
